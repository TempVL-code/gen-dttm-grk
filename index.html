<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤</title>
<style>
body { font-family: Arial, sans-serif; max-width: 900px; margin: 30px auto; }
textarea { width: 100%; height: 220px; }
button { padding: 10px 20px; margin-top: 10px; }
pre { background: #f4f4f4; padding: 10px; white-space: pre-wrap; }
input { width: 60px; }
</style>
</head>
<body>

<h2>üîÅ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –Ω–æ–º–µ—Ä—ñ–≤</h2>

<p>
–í–∫–∞–∂—ñ—Ç—å –≤ —è–∫—ñ–π –∫–æ–ª–æ–Ω—Ü—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ —à—É–∫–∞—Ç–∏ –¥—É–±–ª—ñ–∫–∞—Ç–∏ ‚Ññ
<input type="number" id="colIndex" value="3" min="1">
</p>

<textarea placeholder="–í—Å—Ç–∞–≤ –¥–∞–Ω—ñ (Ctrl+V) –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂ CSV / TSV"></textarea>

<br>
<input type="file" accept=".csv,.tsv,.txt">
<br><br>

<button onclick="checkDuplicates()">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>

<h3>–†–µ–∑—É–ª—å—Ç–∞—Ç (—Ç—ñ–ª—å–∫–∏ –¥—É–±–ª—ñ–∫–∞—Ç–∏):</h3>
<pre id="result"></pre>

<script>
function splitLine(line) {
  // tab, ; , –∞–±–æ –±–∞–≥–∞—Ç–æ –ø—Ä–æ–±—ñ–ª—ñ–≤
  return line.split(/\t|;|,(?=(?:[^"]*"[^"]*")*[^"]*$)|\s{2,}/);
}

function checkDuplicates() {
  const text = document.querySelector("textarea").value.trim();
  const colIndex = parseInt(document.getElementById("colIndex").value, 10) - 1;

  if (!text) return;

  const lines = text.split(/\r?\n/);
  const rows = [];
  const countMap = {};

  for (const line of lines) {
    const cols = splitLine(line);
    if (!cols[colIndex]) continue;

    const number = cols[colIndex].trim();
    rows.push({ line, number });
    countMap[number] = (countMap[number] || 0) + 1;
  }

  let output = "";
  for (const row of rows) {
    if (countMap[row.number] > 1) {
      output += `${row.line} ‚Äî –î—É–±–ª—å\n`;
    }
  }

  document.getElementById("result").textContent =
    output || "–î—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ";
}

document.querySelector("input[type=file]").addEventListener("change", e => {
  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = () => {
    document.querySelector("textarea").value = reader.result;
  };
  reader.readAsText(file);
});
</script>

</body>
</html>
